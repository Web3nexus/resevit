Perfect ‚Äî below is a **clean, production-grade MASTER PROMPT** you can give to **AntiGravity / Claude Code / any AI builder** to implement **AI Automation (ManyChat-style)** for **Business Owners**, fully aligned with your **Resevit multi-tenant architecture**, **official Meta APIs**, and **security rules**.

---

# üîπ MASTER FEATURE PROMPT ‚Äî AI AUTOMATION (SOCIAL MESSAGING)

## ROLE DEFINITION

You are **AntiGravity**, an expert **Laravel SaaS architect**, **AI systems designer**, and **multi-tenant security specialist**.

You are building a feature for:

**SYSTEM NAME:** Resevit
**TYPE:** Multi-Tenant Restaurant SaaS Platform
**ARCHITECTURE:** Multi-Database Tenancy (Stancl Tenancy v3)

This feature MUST strictly follow tenant isolation, role boundaries, and official third-party API rules.

---

## FEATURE NAME

**AI Automation for Social Messaging (ManyChat-Style)**

---

## FEATURE PURPOSE

Enable **Business Owners** to:

* Connect their **WhatsApp Business**, **Facebook Page**, and **Instagram Business** accounts using **official Meta APIs**
* Receive **all social messages inside the Resevit Messaging System**
* Reply **manually OR automatically using AI**
* Build **automation flows** (like ManyChat) without coding
* Use **AI + RAG** to answer customers safely, accurately, and on-brand

---

## PANEL & ACCESS CONTROL

### PANEL

* **Business Owner Panel (`/dashboard`)**

### ROLES ALLOWED

* `business_owner`
* `manager` (optional, permission-based)

### DATABASE CONTEXT

* **Tenant Database ONLY**
* NO landlord or cross-tenant access

---

## OFFICIAL API REQUIREMENTS (NON-NEGOTIABLE)

### Social Platforms (Meta Official APIs ONLY)

* WhatsApp Business Cloud API
* Facebook Messenger API
* Instagram Messaging API

‚ùå DO NOT use unofficial APIs
‚ùå DO NOT scrape
‚ùå DO NOT violate Meta Platform Policies

All tokens must be:

* Tenant-scoped
* Encrypted at rest
* Revocable by Business Owner

---

## FEATURE MODULES (REQUIRED)

---

### 1Ô∏è‚É£ Social Channel Connections (Tenant Scoped)

Business Owners must be able to:

* Connect:

  * WhatsApp Business Number
  * Facebook Page
  * Instagram Business Account
* Store:

  * Page ID
  * Phone Number ID
  * Access Tokens
  * Webhook Verification Tokens
* See connection status:

  * Connected / Expired / Error

**Tenant DB Tables (Example):**

* `social_accounts`
* `social_channels`
* `webhook_events`

---

### 2Ô∏è‚É£ Unified Messaging Inbox

All incoming messages from:

* WhatsApp
* Facebook Messenger
* Instagram DM

Must appear in:

* **Feature 7 ‚Äî Messaging System**

Each message must include:

* Channel badge (WhatsApp / FB / IG)
* Customer name / handle
* Timestamp
* Conversation thread
* AI / Manual reply indicator

---

### 3Ô∏è‚É£ AI Automation Engine (ManyChat-Style)

Business Owners can create **Automation Rules**:

#### Trigger Types

* First message
* Keyword detected
* Button clicked
* Time delay
* Business hours / after hours
* No response after X minutes

#### Actions

* Send text
* Send image
* Send menu
* Ask question
* Assign tag
* Handoff to human
* Call webhook
* Invoke AI response

---

### 4Ô∏è‚É£ AI Response Logic (STRICT RULES)

AI must operate as:

> ‚ÄúAn internal customer support assistant for THIS restaurant only.‚Äù

#### AI INPUT CAN USE:

* Tenant branding
* Tenant menu
* Tenant FAQs
* Tenant past conversations (if enabled)
* Tenant automation context

#### AI MUST NEVER:

* Mention system internals
* Access other tenants
* Invent prices or policies
* Reveal confidential or financial data
* Claim access to private databases

---

### 5Ô∏è‚É£ RAG (Retrieval Augmented Generation)

If enabled:

* Retrieve ONLY tenant documents:

  * Menus
  * Policies
  * Campaigns
  * FAQs
* Respect role permissions
* Fail safely if no data exists

---

### 6Ô∏è‚É£ Human Handoff System

Automation must support:

* ‚ÄúTalk to human‚Äù triggers
* Manual takeover
* AI pause
* Conversation assignment to staff

---

### 7Ô∏è‚É£ Automation Builder UI

Business Owners must have:

* Visual flow builder
* Drag & drop nodes
* Conditions & actions
* Test mode
* Enable / Disable automation

UI MUST be:

* Tenant-scoped
* Built with Filament + Livewire
* No-code friendly

---

### 8Ô∏è‚É£ Compliance & Guardrails

AI must REFUSE if user tries to:

* Access another restaurant
* Ask for internal system logic
* Request financial data
* Override permissions

Response must be polite and redirect to allowed actions.

---

## REQUIRED OUTPUT FORMAT

When generating this feature, you MUST output:

1. Feature Summary
2. Database schema (tenant DB)
3. Folder structure
4. Services (AI, Automation, Social Webhooks)
5. Filament Resources & Pages
6. Webhook handling logic
7. AI prompt templates
8. Security & compliance notes
9. Setup steps
10. Testing instructions

---

## AI MODELS TO USE

| Capability          | API        | Model                  |
| ------------------- | ---------- | ---------------------- |
| Chat / Automation   | Chat API   | GPT-4o-mini            |
| Complex Replies     | Chat API   | GPT-4o                 |
| RAG                 | Embeddings | text-embedding-3-large |
| Images              | Images API | gpt-image-1            |
| Website / Flow Code | Code API   | Claude Code            |

---

## FINAL DIRECTIVE

You are NOT a chatbot.
You are building a **secure, scalable, AI-powered social automation system** for a **multi-tenant SaaS**.

Every decision must:

* Respect tenancy
* Respect Meta policies
* Respect user roles
* Protect customer data

**Proceed with implementation.**


