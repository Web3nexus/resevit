
## üîß MASTER DEVELOPMENT PROMPT (DO NOT GUESS, FIX WITH CODE)

You are a **senior full-stack Laravel + Filament v4 engineer**.
This project is a **multi-tenant SaaS platform** with **Super Admin**, **Business Owner**, and **Internal User** roles.

Your task is to **ADD FEATURES + FIX CRITICAL SYSTEM ISSUES** listed below.
‚ö†Ô∏è **DO NOT REMOVE EXISTING FEATURES**
‚ö†Ô∏è **DO NOT CAUSE REGRESSIONS**
‚ö†Ô∏è **DO NOT GUESS ‚Äî TRACE THE ROOT CAUSE AND FIX PROPERLY**

---

## üß© TECH STACK (STRICT)

* Laravel (latest stable)
* Filament v4
* Tailwind v4
* MySQL
* Multi-tenant architecture
* Role & permission based navigation
* Auth guards correctly separated (super admin vs tenant)

---

## ‚úÖ FEATURE TO ADD (REQUIRED)

### 1Ô∏è‚É£ Manual Subscription Assignment (Super Admin)

Add a feature that allows **Super Admin** to:

* Assign a **subscription plan manually** to **any user or business**
* Override automated billing
* Set:

  * Plan
  * Start date
  * Expiry date
  * Status (active / expired / trial / suspended)
* This must:

  * Reflect immediately across the system
  * Update access permissions correctly
  * Be auditable (log who assigned it and when)

üìç Location:

* Super Admin ‚Üí User Management ‚Üí Assign Subscription

---

## üêõ CRITICAL BUG FIXES (MANDATORY)

### 2Ô∏è‚É£ Landing Page Showing 404 (DO NOT REMOVE IT)

* The **landing page must NEVER return 404**
* Ensure:

  * Route exists
  * Controller exists
  * View exists
* Fix any middleware or tenant detection logic that is blocking public access
* Landing page must be accessible without authentication

---

### 3Ô∏è‚É£ Dashboard Widget Count Is Wrong

**Problem:**

* Super Admin dashboard widget shows:

  * `Total Businesses = 10`
* But:

  * Business owners list shows only `1`

**Fix:**

* Identify incorrect query logic
* Ensure:

  * Widgets count real businesses
  * Filters respect tenant boundaries correctly
* Explain and fix:

  * Why the mismatch happens
  * Where the query is wrong
  * Correct aggregation logic

---

### 4Ô∏è‚É£ Business Owner Sidebar Is Broken

**Problem:**
When impersonating a Business Owner:

* Sidebar only shows:

  * Dashboard
  * Investment Opportunity
* Missing expected modules

**Fix:**

* Ensure:

  * Role-based navigation is correct
  * Filament navigation groups are not filtered incorrectly
  * Permissions are applied properly
* Sidebar should dynamically reflect:

  * Business owner permissions
  * Active subscription features

---

### 5Ô∏è‚É£ Profile Dropdown Opens by Default (BUG)

**Problem:**

* Profile avatar dropdown is **open by default**
* Only happens on **Business Owner pages**

**Fix:**

* Identify:

  * Alpine / JS / Filament state issue
* Ensure:

  * Dropdown opens **only on click**
  * Works consistently across roles

---

### 6Ô∏è‚É£ Notification Bar Bug (BLOCKING UI)

**Problem:**

* Clicking **Investment Opportunity**:

  * Triggers notification bar
  * Notification cannot be closed
  * UI becomes blocked

**Fix:**

* Identify event listener conflict
* Fix:

  * Notification trigger
  * Close behavior
  * Ensure no global JS conflict
* Notification system must behave normally

---

## üß≠ ROLE & IMPERSONATION RULES

* Super Admin impersonation must:

  * Load correct sidebar
  * Load correct permissions
  * Load correct tenant context
* Business Owner must:

  * See all permitted modules
  * Respect subscription limitations

---

## üß™ QUALITY REQUIREMENTS

* No hardcoded role checks
* Use policies, permissions, and Filament guards
* All fixes must be:

  * Scalable
  * Maintainable
  * Production-safe

---

## üìå OUTPUT EXPECTATION

When responding, you MUST:

1. Explain **why each issue happens**
2. Show **exact files to edit**
3. Provide **corrected code snippets**
4. Explain **how to test each fix**

---

## üö´ DO NOT

* Do not disable features
* Do not remove navigation items
* Do not hide errors
* Do not assume data
* Do not guess
